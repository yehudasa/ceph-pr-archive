crimson/net: encapsulate connection states with protocols crimson
