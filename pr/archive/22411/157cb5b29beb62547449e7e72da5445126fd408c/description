Workqueue code cleanup. common needs-review
