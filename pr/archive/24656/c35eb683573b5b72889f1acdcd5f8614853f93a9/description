crimson/net: encapsulate protocol implementations with states crimson
